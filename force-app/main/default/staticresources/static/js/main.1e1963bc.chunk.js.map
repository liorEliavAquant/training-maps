{"version":3,"sources":["logo.svg","components/context/MarkersReducer.js","components/context/MarkersState.js","components/MarkerForm/MarkerForm.js","config.js","components/Map/Map.js","App.js","index.js"],"names":["module","exports","state","data","marker","action","markers","index","findIndex","location","splice","JSON","parse","stringify","markersInitial","MarkersContext","createContext","MarkersProvider","children","useReducer","MarkersReducer","dispach","Provider","value","editMarkers","MarkerForm","className","useContext","useState","lat","setLat","long","setLong","removeMarkerHandler","placeholder","min","max","type","name","onChange","event","target","Button","onClick","isLatValid","isLongValid","alert","map","i","key","config","Map","setMap","Microsoft","setMicrosoft","context","mapMarkers","loadBingApi","a","url","Promise","resolve","reject","script","document","createElement","async","defer","src","window","Maps","zoom","onerror","error","body","appendChild","useEffect","Array","isArray","entities","getLength","get","Pushpin","removeAt","deleteMapPins","Polygon","deleteMapPolygons","forEach","contextMarker","indexOf","push","Location","color","generateNewPin","length","polygonVertices","mapMarker","fillColor","strokeColor","strokeThickness","createPolygonFromMapMarkers","id","App","ReactDOM","render","StrictMode","getElementById"],"mappings":"yLAAAA,EAAOC,QAAU,IAA0B,kC,kJCA5B,WAACC,EAAOC,GACnB,IAAKA,IAASA,EAAKC,SAAWD,EAAKE,OAC/B,OAAOH,EAGX,IAAII,EAAUJ,EAAMI,QAEpB,OAAOH,EAAKE,QACR,IAAK,MACDC,EAAO,sBAAOA,GAAP,CAAgBH,EAAKC,SAC5B,MAEJ,IAAK,SACD,IAAMG,EAAQD,EAAQE,WAAU,SAACJ,GAAD,OAAYA,EAAOK,SAAS,KAAON,EAAKC,OAAOK,SAAS,IAAML,EAAOK,SAAS,KAAON,EAAKC,OAAOK,SAAS,MAC1IH,EAAQI,OAAOH,EAAM,GACrBD,EAAUK,KAAKC,MAAMD,KAAKE,UAAUP,IAQ5C,OAAO,2BACAJ,GADP,IAEII,QAASA,KCtBXQ,EAAiB,CACnBR,QAAS,IAKAS,EAAiBC,wBAAcF,GAE/BG,EAAkB,SAAC,GAAkB,IAAhBC,EAAe,EAAfA,SAAe,EACpBC,qBAAWC,EAAgBN,GADP,mBACtCZ,EADsC,KAC/BmB,EAD+B,KAO7C,OAAQ,kBAACN,EAAeO,SAAhB,CAAyBC,MAAO,CACpCjB,QAASJ,EAAMI,QACfkB,YANgB,SAACrB,GACjBkB,EAAQlB,MAOPe,ICjBIO,EAAa,SAAC,GAAmB,IAAjBC,EAAgB,EAAhBA,UAEnBpB,EAAUqB,qBAAWZ,GAFc,EAGnBa,mBAAS,MAHU,mBAGlCC,EAHkC,KAG7BC,EAH6B,OAIjBF,mBAAS,MAJQ,mBAIlCG,EAJkC,KAI5BC,EAJ4B,KA0BnCC,EAAsB,SAAC7B,GACzB,OAAO,WACHE,EAAQkB,YAAY,CAChBpB,OAAQA,EACRC,OAAQ,aAKpB,OACI,yBAAKqB,UAAWA,GACZ,uDACA,0BAAMA,UAAU,IACZ,2BAAOQ,YAAY,MAAMC,IAAI,MAAMC,IAAI,KAAKC,KAAK,SAASC,KAAK,MAAMC,SAAU,SAACC,GAAD,OAAWV,EAAOU,EAAMC,OAAOlB,UAC9G,2BAAOW,YAAY,OAAOC,IAAI,OAAOC,IAAI,MAAMC,KAAK,SAASC,KAAK,OAAOC,SAAU,SAACC,GAAD,OAAWR,EAAQQ,EAAMC,OAAOlB,UACnH,kBAACmB,EAAA,EAAD,CAAQhB,UAAU,UAAUiB,QA3BnB,WACjB,IAAKZ,IAASF,IATC,SAACA,GAChB,OAAOA,GAAO,IAAMA,IAAQ,GAQNe,CAAWf,KALjB,SAACE,GACjB,OAAOA,GAAQ,KAAOA,IAAS,IAIWc,CAAYd,GAClD,OAAOe,MAAM,kCAEjBxC,EAAQkB,YAAY,CAChBpB,OAAQ,CACJ,SAAY,CAACyB,EAAKE,IAEtB1B,OAAQ,UAmBJ,eAEJ,4BACKC,EAAQA,QAAQyC,KAAI,SAAC3C,EAAQ4C,GAAT,OAAgB,wBAAItB,UAAU,cAAcuB,IAAKD,GACtE,6BAAM,QAAU5C,EAAOK,SAAS,GAAK,SAAWL,EAAOK,SAAS,IAChE,kBAACiC,EAAA,EAAD,CAAQC,QAASV,EAAoB7B,IAArC,iB,wBCnDH8C,EACU,mECGVC,EAAM,SAAC,GAAkB,EAAhBzB,UAAiB,IAAD,EAEdE,mBAAS,MAFK,mBAE7BmB,EAF6B,KAExBK,EAFwB,OAGFxB,mBAAS,MAHP,mBAG7ByB,EAH6B,KAGlBC,EAHkB,KAI5BC,EAAU5B,qBAAWZ,GACrByC,EAAa,GAEbC,EAAW,uCAAG,WAAOR,GAAP,eAAAS,EAAA,4DACK,eACjBC,EAFY,4DACK,eADL,gBAEmEV,GAFnE,kBAIT,IAAIW,SAAQ,SAACC,EAASC,GACzB,IAAMC,EAASC,SAASC,cAAc,UACtCF,EAAO1B,KAAO,kBACd0B,EAAOG,OAAQ,EACfH,EAAOI,OAAQ,EACfJ,EAAOK,IAAMT,EAEbU,OAAM,aAAiB,WACnBf,EAAae,OAAOhB,WACpBD,EAAOiB,OAAOhB,UAAUiB,KAAKnB,IAAtB,WAnBE,WAmB4C,CACjDoB,KAAM,MAGdR,EAAOS,QAAU,SAACC,GACdX,EAAOW,IAEXT,SAASU,KAAKC,YAAYZ,OApBd,2CAAH,sDAwBjBa,qBAAU,WACNnB,EAAYP,KACb,IAwDH,OAnBA0B,qBAAU,WACDrB,GAAYsB,MAAMC,QAAQvB,EAAQjD,UAAayC,KAVlC,WAClB,IAAK,IAAIC,EAAID,EAAIgC,SAASC,YAAc,EAAGhC,GAAK,EAAGA,IAAK,CACtCD,EAAIgC,SAASE,IAAIjC,aACRK,EAAUiB,KAAKY,SAClCnC,EAAIgC,SAASI,SAASnC,IAU9BoC,GAjCsB,WACtB,IAAK,IAAIpC,EAAID,EAAIgC,SAASC,YAAc,EAAGhC,GAAK,EAAGA,IAAK,CACtCD,EAAIgC,SAASE,IAAIjC,aACRK,EAAUiB,KAAKe,SAClCtC,EAAIgC,SAASI,SAASnC,IA8B9BsC,GACA/B,EAAQjD,QAAQiF,SAAQ,SAAAC,IACuB,IAAvChC,EAAWiC,QAAQD,KACnBhC,EAAWkC,KAAKF,GAChBzC,EAAIgC,SAASW,KA7CF,SAACF,GACpB,IAAM/E,EAAW,IAAI4C,EAAUiB,KAAKqB,SAASH,EAAc/E,SAAS,GAAI+E,EAAc/E,SAAS,IAC/F,OAAO,IAAI4C,EAAUiB,KAAKY,QAAQzE,EAAU,CACxCmF,MAAO,UA0CeC,CAAeL,IAE7BhC,EAAWsC,OAAS,GACpB/C,EAAIgC,SAASW,KAhCO,WAChC,IAAMK,EAAkBvC,EAAWT,KAAI,SAAAiD,GAAS,OAAI,IAAI3C,EAAUiB,KAAKqB,SAASK,EAAUvF,SAAS,GAAIuF,EAAUvF,SAAS,OAE1H,OADAsF,EAAgBL,KAAK,IAAIrC,EAAUiB,KAAKqB,SAASnC,EAAW,GAAG/C,SAAS,GAAI+C,EAAW,GAAG/C,SAAS,KAC5F,IAAI4C,EAAUiB,KAAKe,QAAQU,EAAiB,CAC/CE,UAAW,yBACXC,YAAa,WACbC,gBAAiB,IA0BSC,WAI/B,CAAC7C,EAAQjD,UAGR,yBAAK+F,GAzFY,aCaVC,MAXf,WACE,OACE,kBAAC,EAAD,KACE,yBAAK5E,UAAU,QACb,kBAAC,EAAD,CAAYA,UAAU,iBACtB,kBAAC,EAAD,CAAKA,UAAU,WCPvB6E,IAASC,OACP,kBAAC,IAAMC,WAAP,KACE,kBAAC,EAAD,OAEFzC,SAAS0C,eAAe,W","file":"static/js/main.1e1963bc.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/logo.5d5d9eef.svg\";","export default (state, data) => {\n    if (!data || !data.marker || !data.action) {\n        return state;\n    }\n\n    let markers = state.markers\n\n    switch(data.action){\n        case 'add': {\n            markers = [...markers, data.marker]\n            break;\n        }\n        case 'remove': {\n            const index = markers.findIndex((marker) => marker.location[0] === data.marker.location[0] && marker.location[1] === data.marker.location[0])\n            markers.splice(index,1)\n            markers = JSON.parse(JSON.stringify(markers))\n            break;\n        }\n        default:{\n            break;\n        }\n    }\n\n    return {\n        ...state,\n        markers: markers\n    }\n}","import React, { createContext, useReducer } from 'react';\nimport MarkersReducer from './MarkersReducer';\n\nconst markersInitial = {\n    markers: [\n\n    ]\n};\n\nexport const MarkersContext = createContext(markersInitial);\n\nexport const MarkersProvider = ({ children }) => {\n    const [state, dispach] = useReducer(MarkersReducer, markersInitial);\n\n    const editMarkers = (data) => {\n        dispach(data);\n    }\n\n    return (<MarkersContext.Provider value={{\n        markers: state.markers,\n        editMarkers\n    }}>\n        {children}\n    </MarkersContext.Provider>)\n}","import React, { useContext, useState } from 'react'\nimport Button from '@material-ui/core/Button';\nimport { MarkersContext } from '../context/MarkersState';\n\n\nexport const MarkerForm = ({ className }) => {\n\n    const markers = useContext(MarkersContext);\n    const [lat, setLat] = useState(null)\n    const [long, setLong] = useState(null)\n\n    const isLatValid = (lat) => {\n        return lat <= 90 && lat >= -90;\n    }\n\n    const isLongValid = (long) => {\n        return long <= 180 && long >= -180;\n    }\n    // we still have a bug happening here\n    const addNewMarker = () => {\n        if (!long || !lat || !isLatValid(lat) || !isLongValid(long)) {\n            return alert('please insert a valid location');\n        }\n        markers.editMarkers({\n            marker: {\n                \"location\": [lat, long]\n            },\n            action: 'add'\n        })\n    }\n\n    const removeMarkerHandler = (marker) => {\n        return () => {\n            markers.editMarkers({\n                marker: marker,\n                action: 'remove'\n            })\n        }\n    }\n\n    return (\n        <div className={className}>\n            <h2>Add a marker to the map</h2>\n            <form className=\"\">\n                <input placeholder=\"Lat\" min=\"-90\" max=\"90\" type=\"number\" name=\"lat\" onChange={(event) => setLat(event.target.value)}></input>\n                <input placeholder=\"Long\" min=\"-180\" max=\"180\" type=\"number\" name=\"long\" onChange={(event) => setLong(event.target.value)}></input>\n                <Button className='add-btn' onClick={addNewMarker}>Add Marker</Button>\n            </form>\n            <ul>\n                {markers.markers.map((marker, i) => (<li className='marker-item' key={i}>\n                <div>{'Long:' + marker.location[0] + ', Lat:' + marker.location[1]}</div>\n                <Button onClick={removeMarkerHandler(marker)}>Delete</Button>\n                </li>))}\n            </ul>\n        </div>\n    )\n}\n","export const config = {\n    BING_MAPS_API_KEY: \"AqePFAStZ3Lh5wkPuWnoLbUcCHBTaEvjeFUhIwYum0dWLaylHeYT8NDkEBwZthpN\"\n}\n\n// key should not be in source control...","import React, { UseContext, useState, useContext, useEffect } from 'react'\nimport { config } from '../../config'\nimport { MarkersContext } from '../context/MarkersState';\n\nexport const Map = ({ className }) => {\n    const mapElementId = 'bingMap';\n    let [map, setMap] = useState(null);\n    let [Microsoft, setMicrosoft] = useState(null);\n    const context = useContext(MarkersContext);\n    const mapMarkers = [];\n\n    const loadBingApi = async (key) => {\n        const callbackName = \"bingAPIReady\";\n        let url = `https://www.bing.com/api/maps/mapcontrol?callback=${callbackName}&key=${key}`;\n\n        return new Promise((resolve, reject) => {\n            const script = document.createElement(\"script\");\n            script.type = \"text/javascript\";\n            script.async = true;\n            script.defer = true;\n            script.src = url;\n\n            window[callbackName] = () => {\n                setMicrosoft(window.Microsoft);\n                setMap(window.Microsoft.Maps.Map(`#${mapElementId}`, {\n                    zoom: 3\n                }));\n            };\n            script.onerror = (error) => {\n                reject(error);\n            };\n            document.body.appendChild(script);\n        });\n    }\n\n    useEffect(() => {\n        loadBingApi(config.BING_MAPS_API_KEY)\n    }, [])\n\n    const generateNewPin = (contextMarker) => {\n        const location = new Microsoft.Maps.Location(contextMarker.location[0], contextMarker.location[1]);\n        return new Microsoft.Maps.Pushpin(location, {\n            color: 'green'\n        });\n    }\n\n    const deleteMapPolygons = () => {\n        for (var i = map.entities.getLength() - 1; i >= 0; i--) {\n            var polygon = map.entities.get(i);\n            if (polygon instanceof Microsoft.Maps.Polygon) {\n                map.entities.removeAt(i);\n            }\n        }\n    }\n\n    const createPolygonFromMapMarkers = () => {\n        const polygonVertices = mapMarkers.map(mapMarker => new Microsoft.Maps.Location(mapMarker.location[0], mapMarker.location[1]));\n        polygonVertices.push(new Microsoft.Maps.Location(mapMarkers[0].location[0], mapMarkers[0].location[1]))\n        return new Microsoft.Maps.Polygon(polygonVertices, {\n            fillColor: 'rgba(69, 91, 128, 0.5)',\n            strokeColor: 'darkgrey',\n            strokeThickness: 2\n        });\n    }\n\n    const deleteMapPins = () => {\n        for (var i = map.entities.getLength() - 1; i >= 0; i--) {\n            var polygon = map.entities.get(i);\n            if (polygon instanceof Microsoft.Maps.Pushpin) {\n                map.entities.removeAt(i);\n            }\n        }\n    }\n\n    useEffect(() => {\n        if (!context || !Array.isArray(context.markers) || !map) {\n            return;\n        }\n\n        deleteMapPins()\n        deleteMapPolygons();\n        context.markers.forEach(contextMarker => {\n            if (mapMarkers.indexOf(contextMarker) === -1) {\n                mapMarkers.push(contextMarker);\n                map.entities.push(generateNewPin(contextMarker));\n\n                if (mapMarkers.length > 1) {\n                    map.entities.push(createPolygonFromMapMarkers());\n                }\n            }\n        })\n    }, [context.markers]);\n\n    return (\n        <div id={mapElementId} />\n    )\n}\n","import React from 'react';\nimport logo from './logo.svg';\nimport styles from './App.scss';\nimport { MarkerForm } from './components/MarkerForm/MarkerForm';\nimport { Map } from './components/Map/Map';\nimport { MarkersProvider } from './components/context/MarkersState';\n\nfunction App() {\n  return (\n    <MarkersProvider>\n      <div className=\"main\">\n        <MarkerForm className=\"markers-form\"></MarkerForm>\n        <Map className=\"map\"></Map>\n      </div>\n    </MarkersProvider>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.scss';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n"],"sourceRoot":""}